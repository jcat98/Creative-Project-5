{"ast":null,"code":"import _regeneratorRuntime from\"/usr/share/caddy/learning-mongo/lesson3/front-end/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/usr/share/caddy/learning-mongo/lesson3/front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/usr/share/caddy/learning-mongo/lesson3/front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import Button from'react-bootstrap/Button';import Card from'react-bootstrap/Card';import axios from'axios';import'./Feed.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){// setup state\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),rants=_useState2[0],setRants=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),problem=_useState6[0],setProblem=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),username=_useState8[0],setUsername=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),place=_useState10[0],setPlace=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),users=_useState12[0],setUsers=_useState12[1];var fetchRants=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/rants\");case 3:response=_context.sent;setRants(response.data.rants);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setError(\"error retrieving rants: \"+_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function fetchRants(){return _ref.apply(this,arguments);};}();var createRant=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"/api/rants\",{problem:problem,username:username,place:place});case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);setError(\"error adding a rant: \"+_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function createRant(){return _ref2.apply(this,arguments);};}();var deleteOneRant=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(rant){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.delete(\"/api/rants/\"+rant.id);case 3:_context3.next=8;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);setError(\"error deleting a rant\"+_context3.t0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);}));return function deleteOneRant(_x){return _ref3.apply(this,arguments);};}();var fetchUsers=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.get(\"/api/users\");case 3:response=_context4.sent;setUsers(response.data.users);_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);setError(\"error retrieving users: \"+_context4.t0);case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function fetchUsers(){return _ref4.apply(this,arguments);};}();// fetch ticket data\nuseEffect(function(){fetchRants();fetchUsers();},[]);var addRant=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:e.preventDefault();_context5.next=3;return createRant();case 3:fetchRants();setProblem(\"\");setUsername(\"\");setPlace(\"\");case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function addRant(_x2){return _ref5.apply(this,arguments);};}();var deleteRant=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(rant){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return deleteOneRant(rant);case 2:fetchRants();case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function deleteRant(_x3){return _ref6.apply(this,arguments);};}();// render results\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[error,/*#__PURE__*/_jsx(\"h1\",{children:\"Feed\"}),rants.map(function(rant){return/*#__PURE__*/_jsxs(Card,{className:\"rant\",children:[/*#__PURE__*/_jsx(Card.Header,{children:rant.username}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Text,{children:rant.problem}),/*#__PURE__*/_jsx(Button,{className:\"float-end\",variant:\"primary\",onClick:function onClick(e){return deleteRant(rant);},children:\"Delete\"})]})]},rant.id);})]})});};export default Home;","map":{"version":3,"names":["useState","useEffect","Button","Card","axios","Home","rants","setRants","error","setError","problem","setProblem","username","setUsername","place","setPlace","users","setUsers","fetchRants","get","response","data","createRant","post","deleteOneRant","rant","delete","id","fetchUsers","addRant","e","preventDefault","deleteRant","map"],"sources":["/usr/share/caddy/learning-mongo/lesson3/front-end/src/pages/Feed.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Card from 'react-bootstrap/Card';\nimport axios from 'axios';\nimport './Feed.css';\n\nconst Home =() => {\n  // setup state\n  const [rants, setRants] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [problem, setProblem] = useState(\"\");\n  const [username, setUsername] = useState(\"\");\n  const [place, setPlace] = useState(\"\");\n  const [users, setUsers] = useState([]);\n\n  const fetchRants = async() => {\n    try {      \n      const response = await axios.get(\"/api/rants\");\n      setRants(response.data.rants);\n    } catch(error) {\n      setError(\"error retrieving rants: \" + error);\n    }\n  }\n  const createRant = async() => {\n    try {\n      await axios.post(\"/api/rants\", {problem: problem, username: username, place: place});\n    } catch(error) {\n      setError(\"error adding a rant: \" + error);\n    }\n  }\n  const deleteOneRant = async(rant) => {\n    try {\n      await axios.delete(\"/api/rants/\" + rant.id);\n    } catch(error) {\n      setError(\"error deleting a rant\" + error);\n    }\n  }\n  \n  const fetchUsers = async() => {\n    try {      \n      const response = await axios.get(\"/api/users\");\n      setUsers(response.data.users);\n    } catch(error) {\n      setError(\"error retrieving users: \" + error);\n    }\n  }\n\n  // fetch ticket data\n  useEffect(() => {\n    fetchRants();\n    fetchUsers();\n  },[]);\n\n  const addRant = async(e) => {\n    e.preventDefault();\n    await createRant();\n    fetchRants();\n    setProblem(\"\");\n    setUsername(\"\");\n    setPlace(\"\");\n  }\n\n  const deleteRant = async(rant) => {\n    await deleteOneRant(rant);\n    fetchRants();\n  }\n\n  // render results\n  return (\n    <div className=\"container\">\n        <div className=\"App\">\n            {error}\n            <h1>Feed</h1>\n          \n            {rants.map( rant => (\n                <Card key={rant.id} className=\"rant\">\n                  <Card.Header>{rant.username}</Card.Header>\n                  <Card.Body>\n                    <Card.Text>\n                      {rant.problem}\n                    </Card.Text>\n                    <Button className=\"float-end\" variant=\"primary\" onClick={e => deleteRant(rant)}>Delete</Button>\n                  </Card.Body>\n                </Card>\n            ))}\n        </div>\n    </div>\n  );\n}\n\nexport default Home;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}